<!DOCTYPE html>

<html lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>Product Grid</title>
<link href="https://fonts.googleapis.com/css2?family=Roboto+Slab&amp;display=swap" rel="stylesheet"/>
<style>
.fixed-spinner-wrapper {
  height: 20px;
  display: flex;
  align-items: center;
  justify-content: center;
}
.mini-spinner {
  width: 20px;
  height: 20px;
  border: 2px solid #fff;
  border-top: 2px solid rgba(255,255,255,0.2);
  border-radius: 50%;
  animation: spin 0.6s linear infinite;
  display: inline-block;
  vertical-align: middle;
}

@keyframes spin {
  0% { transform: rotate(0deg); }
  100% { transform: rotate(360deg); }
}
    body {
      margin: 0;
      font-family: 'Roboto Slab', serif;
      background: #ffffff;
      color: #222;
    }

    .section-title {
  font-size: 16px;         /* smaller font size */
  font-weight: 400;        /* normal font weight */
  text-align: center;
  padding: 14px 12px 8px;  /* reduced padding */
  background: #fff;
}

    
.product-grid {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 14px;
  padding: 10px;
}


    .product {
      position: relative;
    }

    
  .product img {
  width: 100%;
  aspect-ratio: 1 / 1;
  border-radius: 20px;
  object-fit: cover;
  transition: transform 0.3s ease;
}

.product:hover img {
  transform: scale(1.06);
}

    
    .badge {
      position: absolute;
      top: 8px;
      left: 8px;
      background: #ffcc00;
      color: #000;
      font-size: 11px;
      font-weight: 600;
      padding: 4px 8px;
      border-radius: 6px;
      box-shadow: 0 1px 3px rgba(0,0,0,0.2);
    }

    .product-info {
      margin-top: 8px;
      font-size: 14px;
      text-align: center;
      font-family: 'Roboto Slab', serif;
    }

    .product-info s {
      color: #999;
      margin-right: 6px;
    }

    .product-info b {
      color: #222;
      font-size: 15px;
    }

    .add-btn {
      display: inline-block;
      margin-top: 6px;
      padding: 6px 14px;
      font-size: 13px;
      background: linear-gradient(135deg, #3b82f6, #2563eb);
      color: white;
      border: none;
      border-radius: 50px;
      cursor: pointer;
      transition: background 0.3s ease, transform 0.2s;
    }

    .add-btn:disabled {
      background: #ccc;
      cursor: not-allowed;
    }

    .add-btn:hover {
      background: linear-gradient(135deg, #2563eb, #1d4ed8);
      transform: scale(1.03);
    }
  
/* === HEADER + ANNOUNCEMENT BAR === */
.site-header {
  background-color: #ffffff;
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 12px 16px; /* âœ… fixed */
  box-shadow: 0 2px 10px rgba(0, 0, 0, 0.06);
  min-height: 56px;   /* âœ… fixed height */
}

.left-section {
  display: flex;
  align-items: center;
  gap: 10px;
}

.hamburger-wrapper {
  width: 24px;
  height: 20px;
  cursor: pointer;
  display: flex;
  flex-direction: column;
  justify-content: space-between;
  background-color: transparent;
  border: none;
  padding: 0;
  -webkit-tap-highlight-color: transparent;
  touch-action: manipulation;
}

.hamburger-wrapper div {
  width: 100%;
  height: 3px;
  background-color: #000;
  border-radius: 2px;
}

.logo-img {
  width: 48px;
  height: 48px;
  border-radius: 50%;
  object-fit: cover;
}

.right-icon {
  width: 32px;
  height: 32px;
  object-fit: cover;
  cursor: pointer;
  border-radius: 50%;
  -webkit-tap-highlight-color: transparent;
  touch-action: manipulation;
}

#announcementBar {
  margin: 0;
  padding: 6px 10px;
  font-size: 13px;
  color: #ffffff;
  background: #000000;
  border-top: none;
  border-bottom: none;
  font-weight: 500;
  text-align: center;
  font-family: 'Roboto Slab', serif;
  min-height: 24px;
  line-height: 22px;
  user-select: none;
}
/* === Popup Animation & Layout === */
@keyframes popupFadeIn {
  from { transform: scale(0.95); opacity: 0; }
  to   { transform: scale(1); opacity: 1; }
}

@keyframes popupFadeOut {
  from { transform: scale(1); opacity: 1; }
  to   { transform: scale(0.95); opacity: 0; }
}

.popup-visible {
  display: flex !important;
  animation: popupFadeIn 0.25s ease-out forwards;
}

.popup-hidden {
  animation: popupFadeOut 0.2s ease-in forwards;
}
</style>
</head>
<body>
<header class="site-header">
<div class="hamburger-wrapper" onclick="toggleMenu()">
<div></div>
<div></div>
<div></div>
</div>
<div style="display: flex; align-items: center; position: absolute; left: 70px; top: 6px;">
<img alt="Precioussly Logo" onclick="location.href = 'https://precioussly.com';" src="https://i.postimg.cc/HnRbjRbh/Best-Logo.png" style="
      width: 110px;
      height: auto;
      object-fit: contain;
      cursor: pointer;
      transition: opacity 0.3s ease;
      -webkit-tap-highlight-color: transparent;
    "/>
</div>

<div style="display: flex; align-items: center; gap: 12px;">
<!-- Search icon -->
<img alt="Search" class="right-icon" src="https://i.postimg.cc/mZq01NH8/IMG-20250801-072508.jpg" style="border-radius: 0; width: 25px; height: 26px; margin-top: 2px;"/>
<!-- Profile icon -->
<img alt="Profile" class="right-icon icon-size" id="profileIcon" onclick="handleProfileClick()" src="https://i.postimg.cc/1tRZMmmB/Profile-Icon.png" style="cursor: pointer;"/>
<!-- Cart icon with badge -->
<a href="https://www.precioussly.com/cart" style="position: relative; display: inline-block; margin-top: 5px;">
<img alt="Cart" class="right-icon icon-size" src="https://i.postimg.cc/MZF8bJh0/Cart-Icon.png"/>
<span id="cartCountBadge" style="position: absolute; top: -6px; right: -6px; background: white; color: black; font-size: 12px; border: 1px solid grey; border-radius: 50%; width: 18px; height: 18px; display: flex; align-items: center; justify-content: center;">0</span>
</a>
</div>



</header>
<!-- Announcement Bar -->
<div id="announcementBar">ðŸ§¿</div>
<div id="content"></div>
<script>
const SHEET_URL = "https://opensheet.elk.sh/1PFz3c1VNcmFo5NkN1xdpCyYxJJGxMlxt1Aw_tWv56nA/Sheet1";

fetch(SHEET_URL)
  .then(res => res.json())
  .then(data => {
    const content = document.getElementById('content');
    let currentSection = '';
    let sectionWrapper;

    data.forEach(item => {
      if (item["Section"]) {
        currentSection = item["Section"];
        const sectionTitle = document.createElement('div');
        sectionTitle.className = 'section-title';
        sectionTitle.innerText = currentSection;
        content.appendChild(sectionTitle);

        sectionWrapper = document.createElement('div');
        sectionWrapper.className = 'product-grid';
        content.appendChild(sectionWrapper);
      }

      if (!item["Product Name"]) return;

      const product = document.createElement('div');
      product.className = 'product';

      const img = document.createElement('img');
      img.src = item["photo 1"];
      img.alt = item["Product Name"];
      img.onclick = () => {
        openPopup(
          item["photo 1"],
          item["Product Name"],
          item["MRP"],
          item["Selling Price"]
        );
      };
      product.appendChild(img);

      const title = document.createElement('div');
      title.style.fontSize = "14px";
      title.style.textAlign = "center";
      title.style.marginTop = "8px";
      title.innerText = item["Product Name"];
      product.appendChild(title);

      if (item["Badge"]) {
        const badge = document.createElement('div');
        badge.className = 'badge';
        badge.innerText = item["Badge"];
        product.appendChild(badge);
      }

      const info = document.createElement('div');
      info.className = 'product-info';

      let priceHTML = "";
      if (item["MRP"] && item["Selling Price"]) {
        const discount = Math.round(((item["MRP"] - item["Selling Price"]) / item["MRP"]) * 100);
        priceHTML = `
          <div><s>â‚¹${item["MRP"]}</s> <b>â‚¹${item["Selling Price"]}</b></div>
          <div style="color:green; font-weight:bold; font-size:13px;">${discount}% off</div>
        `;
      }

      if (+item["in stock"] === 0) {
        info.innerHTML = `
          ${priceHTML}
          <div style="margin-top: 6px; color: red; font-weight: bold;">Out of Stock</div>
        `;
      } else {
        const productData = {
          photo: item["photo 1"],
          name: item["Product Name"],
          mrp: item["MRP"],
          price: item["Selling Price"]
        };

        info.innerHTML = `
          ${priceHTML}
          <button class="add-btn" onclick='addToCartFromGrid(this, ${JSON.stringify(productData)})'>Add to Cart</button>
        `;
      }

      product.appendChild(info);
      sectionWrapper.appendChild(product);
    });
  });
</script>
<div id="popupOverlay" style="display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:#00000099; z-index:9999; justify-content:center; align-items:center;">
<div id="popupContent" style="background:white; border-radius:12px; max-width:90%; max-height:90%; padding:14px; position:relative; overflow:hidden;">
<span onclick="closePopup()" style="position:absolute; top:8px; right:14px; font-size:20px; cursor:pointer;">Ã—</span>
<div id="popupSlider" style="display:flex; overflow-x:auto; scroll-snap-type:x mandatory; gap:10px; border-radius:10px;">
<!-- Images will be injected here -->
</div>
</div>
</div>
<script>
function openPopup(images) {
  const overlay = document.getElementById("popupOverlay");
  const slider = document.getElementById("popupSlider");
  slider.innerHTML = "";

  images.forEach(url => {
    const img = document.createElement("img");
    img.src = url.trim();
    img.style = "aspect-ratio:1/1; width:100%; max-width:300px; border-radius:12px; object-fit:cover; scroll-snap-align:center;";
    slider.appendChild(img);
  });

  overlay.style.display = "flex";
}

function closePopup() {
  document.getElementById("popupOverlay").style.display = "none";
}
  document.getElementById("productPopup").addEventListener("click", function (e) {
    if (e.target.id === "productPopup") {
      closePopup();
    }
  });
</script>
<div id="productPopup" class="popup-hidden" style="display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:#00000099; z-index:9999; justify-content:center; align-items:center;">
<div style="background:white; border-radius:20px; max-width:320px; width:90%; margin: 20px; padding:16px; position:relative; border: 2px solid #000;">
<!-- Close button -->
<div onclick="closePopup()" style="position:absolute; top:10px; right:10px; width:30px; height:30px; background:#000; color:#fff; border-radius:50%; font-size:20px; font-weight:bold; display:flex; align-items:center; justify-content:center; cursor:pointer; box-shadow: 0 2px 6px rgba(0,0,0,0.3);">Ã—</div>
<!-- Square image 1:1 -->
<img id="popupImage" src="" style="width:100%; aspect-ratio:1/1; border-radius:14px; object-fit:cover; margin-bottom:16px;"/>
<!-- Product name on left -->
<div id="popupName" style="font-size:16px; font-weight:600; text-align:left;"></div>
<!-- Price -->
<div id="popupPrice" style="margin:8px 0 16px; font-size:14px; text-align:left;"></div>
<!-- Add to Cart full-width button -->
<button onclick="addToCart()" style="width:100%; background:#2563eb; color:#fff; border:none; border-radius:100px; padding:12px 16px; font-size:15px; font-weight:500; cursor:pointer;">
      Add to Cart
    </button>
</div>
</div>
<div id="addedToast" style="display:none; align-items:center; position:fixed; top:20px; left:50%; transform:translateX(-50%); background:#222; color:#fff; font-size:14px; padding:10px 16px; border-radius:30px; z-index:10000; box-shadow:0 4px 10px rgba(0,0,0,0.2); font-weight:500;">
  <img src="https://i.postimg.cc/hG9Y3dJs/logooo.jpg" style="width:24px; height:24px; border-radius:50%; margin-right:8px;">
  Item added to cart
</div>
<script>
let selectedProduct = null;

// Open popup with product details
function openPopup(image, name, mrp, price) {
  selectedProduct = { image, name, mrp, price };

  document.getElementById("popupImage").src = image;
  document.getElementById("popupName").innerText = name;

  let priceHTML = "";
  if (mrp && price) {
    priceHTML = `<s>â‚¹${mrp}</s> <b>â‚¹${price}</b>`;
  } else if (price) {
    priceHTML = `<b>â‚¹${price}</b>`;
  } else {
    priceHTML = `<span style="color:#999;">Price not available</span>`;
  }

  document.getElementById("popupPrice").innerHTML = priceHTML;

  const popup = document.getElementById("productPopup");
  popup.classList.remove("popup-hidden");
  popup.classList.add("popup-visible");
  popup.style.display = "flex";
}

// Close popup
function closePopup() {
  const popup = document.getElementById("productPopup");
  popup.classList.remove("popup-visible");
  popup.classList.add("popup-hidden");
  setTimeout(() => {
    popup.style.display = "none";
  }, 200);
}

// Add to cart logic
function addToCartFromGrid(button, product) {
  const originalHTML = button.innerHTML;
  button.disabled = true;
  button.innerHTML = '<div class="fixed-spinner-wrapper"><span class="mini-spinner"></span></div>';

  setTimeout(() => {
    button.disabled = false;
    button.innerHTML = originalHTML;

    // Add item to cart
    let cartItems = JSON.parse(localStorage.getItem("cartItems")) || [];
    const existing = cartItems.find(i => i.name === product.name);
    if (existing) {
      existing.qty += 1;
    } else {
      cartItems.push({ ...product, qty: 1 });
    }

    localStorage.setItem("cartItems", JSON.stringify(cartItems));
    updateCartBadge();

    // Show toast
    const toast = document.getElementById("addedToast");
    toast.innerHTML = `
      <img src="https://i.postimg.cc/hG9Y3dJs/logooo.jpg" style="width:24px; height:24px; border-radius:50%; margin-right:8px;">
      Item added to cart
    `;
    toast.style.display = "flex";
    setTimeout(() => {
      toast.style.display = "none";
    }, 2000);
  }, 1000);
}
</script>
<script>
  const announceSheetID = "1tjNd2zp77FVVdJQ181lhwSElZHgk3BT5Ma3_VM9Jafc";
  const announceURL = `https://opensheet.elk.sh/${announceSheetID}/Sheet1`;

  fetch(announceURL)
    .then(res => res.json())
    .then(data => {
      if (data.length > 0 && data[0]["(announcement_text)"]) {
        document.getElementById("announcementBar").innerText = data[0]["(announcement_text)"];
      }
    });

  const photo = localStorage.getItem("user_photo");
  if (photo) {
    document.getElementById("profileIcon").src = photo;
  }

  function handleProfileClick() {
    const isLoggedIn = localStorage.getItem("user_email");
    if (isLoggedIn) {
      window.location.href = "/dashboard";
    } else {
      window.location.href = `https://accounts.google.com/o/oauth2/v2/auth?client_id=746848628668-83a44mlh0klb2kp8gajhi4j26sd33l61.apps.googleusercontent.com&redirect_uri=https://precioussly.com&response_type=token&scope=email%20profile&prompt=consent`;
    }
  }

  function updateCartBadge() {
    const items = JSON.parse(localStorage.getItem("cartItems")) || [];
    let count = 0;
    items.forEach(item => count += item.qty);
    const badge = document.getElementById("cartCountBadge");
    if (badge) {
      if (count > 0) {
        badge.innerText = count;
        badge.style.display = "flex";
      } else {
        badge.style.display = "none";
      }
    }
  }

  updateCartBadge();
</script>
</body>
</html>